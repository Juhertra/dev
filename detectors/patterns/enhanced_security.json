{
  "name": "Enhanced Security Patterns",
  "version": "2.0.0",
  "description": "Enhanced pattern pack demonstrating Phase 3 improvements: validation, evidence capture, and false-positive reduction",
  "author": "Security Toolkit",
  "rules": [
    {
      "id": "xss-reflected-enhanced",
      "title": "Reflected XSS with Enhanced Detection",
      "where": ["response.body"],
      "regex": "(<script[^>]*>.*?\\{\\{.*?\\}\\}.*?</script>|<img[^>]+src=javascript:.*?\\{\\{.*?\\}\\}|<svg[^>]+on[a-z]+\\s*=\\s*['\"].*?\\{\\{.*?\\}\\}['\"])",
      "cwe": "CWE-79",
      "cvss": 6.1,
      "confidence": 75,
      "severity": "medium",
      "tags": ["xss", "reflected", "template-injection"],
      "context_gate": true,
      "content_type_gate": true,
      "minified_gate": true,
      "status_gate": true,
      "allow_binary_content": false,
      "allow_minified_content": false,
      "allow_error_responses": false,
      "allow_redirects": false,
      "allow_large_responses": false
    },
    {
      "id": "sql-injection-enhanced",
      "title": "SQL Injection with Context Validation",
      "where": ["response.body", "response.headers"],
      "regex": "(SQL syntax error|mysql_fetch_array|ORA-\\d+|Microsoft OLE DB|PostgreSQL query failed|Warning: mysql_|valid MySQL result|MySqlClient\\.|System\\.Data\\.SqlClient\\.)",
      "cwe": "CWE-89",
      "cvss": 7.5,
      "confidence": 80,
      "severity": "high",
      "tags": ["sql-injection", "database", "error-message"],
      "context_gate": true,
      "content_type_gate": true,
      "minified_gate": true,
      "status_gate": true,
      "allow_binary_content": false,
      "allow_minified_content": false,
      "allow_error_responses": true,
      "allow_redirects": false,
      "allow_large_responses": false
    },
    {
      "id": "path-traversal-enhanced",
      "title": "Path Traversal with File System Evidence",
      "where": ["response.body"],
      "regex": "(root:x:|bin/bash|etc/passwd|windows/system32|proc/self/environ|boot\\.ini|win\\.ini)",
      "cwe": "CWE-22",
      "cvss": 7.5,
      "confidence": 85,
      "severity": "high",
      "tags": ["path-traversal", "file-disclosure", "directory-traversal"],
      "context_gate": true,
      "content_type_gate": true,
      "minified_gate": true,
      "status_gate": true,
      "allow_binary_content": false,
      "allow_minified_content": false,
      "allow_error_responses": true,
      "allow_redirects": false,
      "allow_large_responses": false
    },
    {
      "id": "sensitive-data-exposure",
      "title": "Sensitive Data Exposure in Response",
      "where": ["response.body", "response.headers"],
      "regex": "(password\\s*[:=]\\s*['\"][^'\"]{3,}['\"]|api[_-]?key\\s*[:=]\\s*['\"][^'\"]{10,}['\"]|secret\\s*[:=]\\s*['\"][^'\"]{10,}['\"]|token\\s*[:=]\\s*['\"][^'\"]{20,}['\"])",
      "cwe": "CWE-200",
      "cvss": 5.3,
      "confidence": 70,
      "severity": "medium",
      "tags": ["sensitive-data", "credentials", "api-key", "secret"],
      "context_gate": true,
      "content_type_gate": true,
      "minified_gate": true,
      "status_gate": true,
      "allow_binary_content": false,
      "allow_minified_content": false,
      "allow_error_responses": true,
      "allow_redirects": false,
      "allow_large_responses": false
    },
    {
      "id": "insecure-deserialization",
      "title": "Insecure Deserialization Indicators",
      "where": ["response.body"],
      "regex": "(java\\.io\\.ObjectInputStream|pickle\\.loads|unserialize\\(|ObjectInputStream|DeserializationException|SerializationException)",
      "cwe": "CWE-502",
      "cvss": 8.8,
      "confidence": 75,
      "severity": "high",
      "tags": ["deserialization", "java", "python", "php"],
      "context_gate": true,
      "content_type_gate": true,
      "minified_gate": true,
      "status_gate": true,
      "allow_binary_content": false,
      "allow_minified_content": false,
      "allow_error_responses": true,
      "allow_redirects": false,
      "allow_large_responses": false
    },
    {
      "id": "xxe-injection",
      "title": "XML External Entity (XXE) Injection",
      "where": ["response.body"],
      "regex": "(<!DOCTYPE.*?<!ENTITY.*?SYSTEM|xmlns:xxe|<!ENTITY\\s+\\w+\\s+SYSTEM\\s+['\"][^'\"]*['\"]|file:///|http://|ftp://)",
      "cwe": "CWE-611",
      "cvss": 7.5,
      "confidence": 80,
      "severity": "high",
      "tags": ["xxe", "xml", "external-entity", "file-disclosure"],
      "context_gate": true,
      "content_type_gate": true,
      "minified_gate": true,
      "status_gate": true,
      "allow_binary_content": false,
      "allow_minified_content": false,
      "allow_error_responses": true,
      "allow_redirects": false,
      "allow_large_responses": false
    },
    {
      "id": "command-injection-enhanced",
      "title": "Command Injection with System Evidence",
      "where": ["response.body"],
      "regex": "(uid=\\d+\\(\\w+\\)|gid=\\d+\\(\\w+\\)|groups=|total \\d+|drwxr-xr-x|Volume Serial Number|Directory of|Microsoft Windows)",
      "cwe": "CWE-78",
      "cvss": 8.8,
      "confidence": 90,
      "severity": "critical",
      "tags": ["command-injection", "os-command", "system-info"],
      "context_gate": true,
      "content_type_gate": true,
      "minified_gate": true,
      "status_gate": true,
      "allow_binary_content": false,
      "allow_minified_content": false,
      "allow_error_responses": true,
      "allow_redirects": false,
      "allow_large_responses": false
    },
    {
      "id": "weak-cryptography",
      "title": "Weak Cryptographic Implementation",
      "where": ["response.body", "response.headers"],
      "regex": "(MD5|SHA1|DES|RC4|md5\\(|sha1\\(|des_encrypt|rc4_encrypt|weak.*crypt|insecure.*hash)",
      "cwe": "CWE-327",
      "cvss": 5.3,
      "confidence": 65,
      "severity": "medium",
      "tags": ["cryptography", "weak-hash", "weak-cipher", "security"],
      "context_gate": true,
      "content_type_gate": true,
      "minified_gate": true,
      "status_gate": true,
      "allow_binary_content": false,
      "allow_minified_content": false,
      "allow_error_responses": true,
      "allow_redirects": false,
      "allow_large_responses": false
    }
  ]
}
